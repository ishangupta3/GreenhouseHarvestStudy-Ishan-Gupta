# Greenhouse Harvest Planning System

A ML-powered harvest planning system for greenhouse operations, built with FastAPI, PostgreSQL, and Docker.

## 🎯 Project Overview

This system helps greenhouse operations teams schedule harvests using machine learning predictions. The application targets specific weeks (July 21-28, 2025) with a goal of 4kg daily per crop type (Lettuce, Arugula, Spinach, Kale) for 5 work days per week.

## 🚀 Quick Start

### Prerequisites
- Docker and Docker Compose
- Git

### Installation & Setup

1. **Clone the repository**
   ```bash
   git clone <your-repo-url>
   cd fullstack-case-study-2025
   ```

2. **Start the system**
   ```bash
   docker-compose up -d
   ```

3. **Access the application**
   - **Web Interface:** http://localhost:8000
   - **API Documentation:** http://localhost:8000/docs
   - **Database:** localhost:5432 (postgres/postgres)

## 🏗️ System Architecture

### Backend (FastAPI)
- **Framework:** FastAPI with SQLAlchemy ORM
- **Database:** PostgreSQL with ML predictions
- **Key Features:**
  - ML-powered harvest scheduling
  - RESTful API endpoints
  - Real-time crop availability
  - Confidence-based optimization

### Frontend (HTML/JavaScript)
- **Interface:** Clean, intuitive web UI
- **Features:**
  - Weekly harvest planning view
  - ML prediction analysis
  - System overview dashboard
  - Real-time data updates

### Database
- **Tables:** crop_cycles, locations, ml_harvest_predictions
- **Views:** ready_for_harvest, harvest_planning, greenhouse_occupancy, greenhouse_layout
- **ML Data:** 6,690+ predictions for July 21-28, 2025

## 📊 Key Features

### 1. ML-Powered Scheduling
- Uses machine learning predictions for optimal harvest timing
- Confidence-based crop selection
- Yield optimization algorithms

### 2. Target Week Planning
- **Week 1:** July 21-25 (Monday-Friday)
- **Week 2:** July 28 (Monday)
- 4kg daily target per crop type

### 3. Real-time Data
- Live crop availability
- ML prediction analysis
- Greenhouse occupancy tracking

### 4. RESTful API
- `/api/crops/active` - Get active crops
- `/api/schedule/weekly` - Weekly harvest plans
- `/api/predictions/{date}` - ML predictions for date
- `/api/schedule/harvest` - Schedule specific harvest

## 🔧 Development

### Project Structure
```
├── app/
│   ├── __init__.py
│   ├── main.py              # FastAPI application
│   ├── database.py          # Database connection
│   ├── models.py            # SQLAlchemy models
│   ├── schemas.py           # Pydantic schemas
│   └── harvest_planner.py   # Core planning logic
├── templates/
│   └── index.html           # Web interface
├── database/
│   └── init-db/             # Database initialization
├── docker-compose.yml       # Docker services
├── Dockerfile              # API container
└── requirements.txt        # Python dependencies
```

### Running in Development
```bash
# Start services
docker-compose up -d

# View logs
docker-compose logs -f api

# Stop services
docker-compose down
```

### API Testing
```bash
# Test API endpoints
curl http://localhost:8000/api/crops/active
curl http://localhost:8000/api/schedule/target-weeks
```

## 📈 ML Prediction Strategy

### Available Data
- **6,690 ML predictions** for target weeks
- **723-948 predictions per day**
- **High confidence scores** (0.8+ average)
- **Yield range:** 543g - 5,053g per crop

### Scheduling Algorithm
1. **Filter by confidence** (≥0.8)
2. **Find single large crops** (≥4,000g)
3. **Combine smaller crops** if needed
4. **Optimize for variety distribution**

### Target Achievement
- **Lettuce:** 530,000-743,000g daily available (133x target)
- **Kale:** 374,000-573,000g daily available (94x target)
- **Spinach:** 337,000-504,000g daily available (84x target)
- **Arugula:** 287,000-435,000g daily available (72x target)

## 🎯 Success Metrics

### Functional Requirements ✅
- [x] Schedule harvests for July 21-28, 2025
- [x] Target 4kg daily per crop type
- [x] 5-day work week planning
- [x] ML prediction integration

### Technical Requirements ✅
- [x] Python REST API (FastAPI)
- [x] PostgreSQL database
- [x] Docker Compose setup
- [x] Simple web interface
- [x] Well-documented code

## 🔮 Future Enhancements

1. **Database Migrations** - Alembic for schema changes
2. **Authentication** - User management system
3. **Advanced Analytics** - Historical performance tracking
4. **Mobile Interface** - Responsive design improvements
5. **Real-time Updates** - WebSocket integration

## 📝 License

This project is part of the Hippo Harvest case study.

---

**Built with ❤️ for sustainable agriculture**
